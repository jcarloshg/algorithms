# malware_signature_detection.py

# The Challenge: "Malware Signature Detection"
#
# Context:
# You are building an antivirus engine. You have a massive binary data stream
# (string s) and a known malicious signature (string p). However, the malware
# is polymorphicâ€”it scrambles the order of its instructions to evade detection.
# You need to find all start indices where the malware signature appears in s,
# regardless of the character order (i.e., find all anagrams).
#
# Problem Statement: Given two strings s and p, return an array of all the start
# indices of p's anagrams in s. You may return the answer in any order.

# Examples:

# Input: s = "cbaebabacd", p = "abc"
# Output: [0, 6]
# Explanation:
# The substring with start index = 0 is "cba", which is an anagram of "abc".
# The substring with start index = 6 is "bac", which is an anagram of "abc".

# Input: s = "abab", p = "ab"
# Output: [0, 1, 2]
# Explanation:
# At 0: "ab" (Match)
# At 1: "ba" (Match)
# At 2: "ab" (Match)

def findAnagrams(s: str, p: str) -> list[int]:

    def get_string_sorted(s: str) -> str:
        s_sorted = ''.join(sorted(s))
        return s_sorted

    p_len = len(p)
    p_sorted = get_string_sorted(p)
    index = []

    for right in range(len(s)):
        left = right - p_len + 1
        sub = s[left:right+1]
        print(right, left, sub)

        sub_sorted = get_string_sorted(sub)
        if sub_sorted == p_sorted:
            index.append(left)

    return index


s_01 = "cbaebabacd"
p_01 = "abc"
result_01 = findAnagrams(s=s_01, p=p_01)
print(f"s_01, p_01 -> {s_01}, {p_01}")
print(f"result_01 {result_01}\n")

s_02 = "abab"
p_02 = "ab"
result_02 = findAnagrams(s=s_02, p=p_02)
print(f"s_02, p_02 -> {s_02}, {p_02}")
print(f"result_02 {result_02}\n")
